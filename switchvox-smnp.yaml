zabbix_export:
  version: '7.2'
  template_groups:
    -
      uuid: e754cf258e324b5eaa4bcf615df64491
      name: Templates/Sensors
  templates:
    -
      uuid: eb193a09b1cf45c080d95ad0caa4e730
      template: 'Sangoma Switchvox by SNMP'
      name: 'Sangoma Switchvox by SNMP'
      description: '## Montioring of Switchvox by SNMP.'
      # The Switchvox prefix is .1.3.6.1.4.1.22736.10
      groups:
        -
          name: Templates/Telephony
      items:
        # .1 Switchvox Information
        -
          uuid: ec0372eebffb4a6caa953dfed1cae318
          name: 'software version'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.1.1
          key: softwareVersion
          delay: 1h
          history: 90d
          trends: '0'
          value_type: CHAR
          description: |
                MIB: SNMPv2-MIB
                Switchvox Software Version.
        -
          uuid: 0ebb2847ad584dda8598beea2d7d68af
          name: 'max concurrent calls'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.1.2
          key: maxConcurrentCalls
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SNMPv2-MIB
                Switchvox Max Concurent Calls.
        -
          uuid: d7bdf8aad73d47adaa0cbb49516fc6bf
          name: 'used feature packs'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.1.3
          key: usedFeaturePacks
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SNMPv2-MIB
                Switchvox Used Feature Packs.
        -
          uuid: 285fdc918a1f4391b9c711dea858c52f
          name:	'max feature packs'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.1.4
          key:	maxFeaturePacks
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SNMPv2-MIB
                Switchvox Max Feature Packs.
        -
          uuid: 648fa7bff77d49eca703e374408d8750
          name:	'used extensions'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.1.5
          key:	usedExtensions
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SNMPv2-MIB
                Switchvox Used Extensions.
        -
          uuid: c28c6fd374044ff3b6b4a372ec7a190d
          name:	'max extensions'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.1.6
          key:	maxExtensions
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SNMPv2-MIB
                Switchvox Max Extensions.
        # .2 VOIP Providers
        -
          uuid: b9dcea2d4f354b3795c6f05f6a51803a
          name:	'VOIP Providers Num of VOIP providers'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.2.1
          key:	voip.provider.numberOfVOIPProviders
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SNMPv2-MIB
                Switchvox number of VOIP providers.
        -
          uuid: e79bfcf96b764ff88627a38e05d6923a
          name:	'VOIP Providers Num of ok Providers'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.2.2
          key:	voip.provider.numberOfStateOkVOIPProviders
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SNMPv2-MIB
                Switchvox number of state Ok VOIP providers. 
      discovery_rules:
        - uuid: 060e2fa4b1fc47bf99f6dfdcfad15cc7
          name: 'VOIP Provider Discovery'
          type: SNMP_AGENT
          snmp_oid: 'walk[.1.3.6.1.4.1.22736.10.2.3]'
          key: voip.provider.discovery
          delay: 1h
          description: 'voipoProviderIndex: The index of the voip provider.'
          preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var arr = value.split("\n");
                      var result = "";
                      var cur = 1;
                      var snmpindex = '';
                      var vpid = '';
                      var vpname = '';
                      result = "[";
                      for (var i = 0; i < arr.length; i++)
                      {
                          var el = arr[i].substring(26,27);
                          if (el == cur) {
                              snmpindex = el;
                              if (arr[i].substring(28,29) == '1')
                              {
                                  temp = arr[i].split(': ');
                                  vpid = temp[1];
                              }else if (arr[i].substring(28,29) == '3'){
                                  temp = arr[i].split(': ');
                                  vpname = temp[1];
                              }
                          }else{
                              result = result + '\r\n\
                          {\r\n\
                              "{#SNMPINDEX}":' + cur + ',\r\n\
                              "{#VPID}": ' + vpid + ',\r\n\
                              "{#VPNAME}": ' + vpname +'\r\n\
                          },\r\n';
                              cur = el;
                              vpid = arr[i].split(': ')[1];
                              vpname = '';
                          }
                      }
                      result = result + '\r\n\
                          {\r\n\
                              "{#SNMPINDEX}":' + cur + ',\r\n\
                              "{#VPID}": ' + vpid + ',\r\n\
                              "{#VPNAME}": ' + vpname +'\r\n\
                          }\r\n]';
                      return (result);
          item_prototypes:
            - uuid: 791e4d77359249028e64918697b0e14e
              name: 'VOIP Provider {#VPID}({#VPNAME}): ID'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.22736.10.2.3.{#SNMPINDEX}.1'
              key: 'voip.provider[id.{#VPID}]'
              delay: 1h
              value_type: FLOAT
              trends: '0'
              description: |
                MIB: SWITCHVOX-MIB::switchvoxVoipProviders 1
                The VOIP Provider ID'
            - uuid: 42bc67a9572c4ce892daf4cd6ec0a19e
              name: 'VOIP Provider {#VPID}({#VPNAME}): Type'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.22736.10.2.3.{#SNMPINDEX}.2'
              key: 'voip.provider[type.{#VPID}]'
              delay: 1h
              value_type: TEXT
              description: |
                MIB: SWITCHVOX-MIB::switchvoxVoipProviders 2
                The VOIP Provider Connection Type'
            - uuid: 5b901c621b1a4c5eb9a30ce33a5663e7
              name: 'VOIP Provider {#VPID}({#VPNAME}): Name'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.22736.10.2.3.{#SNMPINDEX}.3'
              key: 'voip.provider[name.{#VPID}]'
              delay: 1h
              value_type: TEXT
              description: |
                MIB: SWITCHVOX-MIB::switchvoxVoipProviders 3
                The VOIP Provider Connection Name'
            - uuid: f7d91702d6d14fe48d0048c40c1ed7cb
              name: 'VOIP Provider {#VPID}({#VPNAME}): Host'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.22736.10.2.3.{#SNMPINDEX}.4'
              key: 'voip.provider[host.{#VPID}]'
              delay: 1h
              value_type: TEXT
              description: |
                MIB: SWITCHVOX-MIB::switchvoxVoipProviders 4
                The VOIP Provider Connection Host'
            - uuid: 9dac31f21fbe4edbbcbca8637a1ed28b
              name: 'VOIP Provider {#VPID}({#VPNAME}): Account Id'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.22736.10.2.3.{#SNMPINDEX}.5'
              key: 'voip.provider[account.id.{#VPID}]'
              delay: 1h
              value_type: TEXT
              description: |
                MIB: SWITCHVOX-MIB::switchvoxVoipProviders 5
                The VOIP Provider Connection Account ID'
            - uuid: 5037c33835e54290bf64d6cf0f30ccde
              name: 'VOIP Provider {#VPID}({#VPNAME}): Callback Ext.'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.22736.10.2.3.{#SNMPINDEX}.6'
              key: 'voip.provider[callback.ext.{#VPID}]'
              delay: 1h
              value_type: TEXT
              description: |
                MIB: SWITCHVOX-MIB::switchvoxVoipProviders 6
                The VOIP Provider Connection Account Callback extension.'
            - uuid: d6c97d97332d417da104f24dcbc9f6dc
              name: 'VOIP Provider {#VPID}({#VPNAME}): Latency'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.22736.10.2.3.{#SNMPINDEX}.7'
              key: 'voip.provider[latency.{#VPID}]'
              delay: 1h
              value_type: TEXT
              description: |
                MIB: SWITCHVOX-MIB::switchvoxVoipProviders 7
                The VOIP Provider Connection Account Latency.'
            - uuid: 7335ce5b21144d4ebb2f4f1a8ca0d104
              name: 'VOIP Provider {#VPID}({#VPNAME}): State'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.22736.10.2.3.{#SNMPINDEX}.8'
              key: 'voip.provider[state.{#VPID}]'
              delay: 1h
              value_type: TEXT
              description: |
                MIB: SWITCHVOX-MIB::switchvoxVoipProviders 8
                The VOIP Provider Connection Account State.'
