zabbix_export:
  version: '7.2'
  template_groups:
    -
      uuid: e754cf258e324b5eaa4bcf615df64491
      name: Templates/Sensors
  templates:
    -
      uuid: eb193a09b1cf45c080d95ad0caa4e730
      template: 'Sangoma Switchvox by SNMP'
      name: 'Sangoma Switchvox by SNMP'
      description: |
          ## Montioring of Switchvox by SNMP.
          Switchvox is Digium's family of Voice Over IP Phone systems 
          for small and medium businesses.'
      # The Switchvox prefix is .1.3.6.1.4.1.22736.10
      groups:
        -
          name: Templates/Telephony
      items:
        -
          uuid: ec0372eebffb4a6caa953dfed1cae318
          name: 'switchvoxInfo: svoxSoftwareVersion'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.1.1
          key: switchvoxInfo.svoxSoftwareVersion
          delay: 1h
          history: 90d
          trends: '0'
          value_type: CHAR
          description: |
                MIB: SWITCHVOX-MIB
                Software version
                ::= { switchvoxInfo 1 }
        -
          uuid: 0ebb2847ad584dda8598beea2d7d68af
          name: 'switchvoxInfo: svoxMaxConcurrentCalls'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.1.2
          key: switchvoxInfo.svoxMaxConcurrentCalls
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Maximum concurrent calls
                ::= { switchvoxInfo 2 }
        -
          uuid: d7bdf8aad73d47adaa0cbb49516fc6bf
          name: 'switchvoxInfo: svoxUsedPhoneConfigFeaturePacks'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.1.3
          key: switchvoxInfo.svoxUsedPhoneConfigFeaturePacks
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Used phone configuration feature packs
                ::= { switchvoxInfo 3 }
        -
          uuid: 285fdc918a1f4391b9c711dea858c52f
          name:	'switchvoxInfo: svoxMaxPhoneConfigFeaturePacks'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.1.4
          key:	switchvoxInfo.svoxMaxPhoneConfigFeaturePacks
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Maximum phone configuration feature packs
                ::= { switchvoxInfo 4 }
        -
          uuid: 648fa7bff77d49eca703e374408d8750
          name:	'switchvoxInfo: svoxUsedExtensions'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.1.5
          key:	switchvoxInfo.svoxUsedExtensions
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Used extensions
                ::= { switchvoxInfo 5 }
        -
          uuid: c28c6fd374044ff3b6b4a372ec7a190d
          name:	'switchvoxInfo: svoxMaxExtensions'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.1.6
          key:	switchvoxInfo.svoxMaxExtensions
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Maximum extensions
                ::= { switchvoxInfo 6 }
        -
          uuid: b9dcea2d4f354b3795c6f05f6a51803a
          name:	'switchvoxVoipProviders: svoxVoipProviders'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.2.1
          key:	switchvoxVoipProviders.svoxVoipProviders
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Current number of active voip providers
                ::= { switchvoxVoipProviders 1 }
        -
          uuid: e79bfcf96b764ff88627a38e05d6923a
          name:	'switchvoxVoipProviders: svoxAvailableVoipProviders'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.2.2
          key:	switchvoxVoipProviders.svoxAvailableVoipProviders
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Current number of active and available voip providers
                ::= { switchvoxVoipProviders 2 }
        -
          uuid: 3f335c120ff4410e8bc14273b67ebf3e
          name:	'switchvoxHardwareStatus: svoxMemoryUsed'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.3.1.1
          key:	switchvoxHardwareStatus.svoxMemoryUsed
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Memory Used
        -
          uuid: 9496914d063047b5a3bff526cb986bba
          name:	'switchvoxHardwareStatus: svoxMemoryTotal'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.3.1.2
          key:	switchvoxHardwareStatus.svoxMemoryTotal
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Memory Total
        -
          uuid: 991fbfe175c94724b9bbdb18297cb05f
          name:	'switchvoxHardwareStatus: svoxSwapUsed'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.3.1.3
          key:	switchvoxHardwareStatus.svoxSwapUsed
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Swap Used
        -
          uuid: eddd82160e944ddc87f339dde83209ad
          name:	'switchvoxHardwareStatus: svoxSwapTotal'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.3.1.4
          key:	switchvoxHardwareStatus.svoxSwapTotal
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Swap Total
        -
          uuid: 2fe820edae664e6db222b38914e58713
          name:	'switchvoxHardwareStatus: svoxMemoryInfoLastUpdate'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.3.1.5
          key:	switchvoxHardwareStatus.svoxMemoryInfoLastUpdate
          delay: 1h
          history: 90d
          trends: '0'
          value_type: TEXT
          description: |
                MIB: SWITCHVOX-MIB
                Memory Info Last Updated
        -
          uuid: 4e91183a6bc14571837d96a132a1a4cb
          name:	'switchvoxHardwareStatus: svoxDiskUsed'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.3.2.1
          key:	switchvoxHardwareStatus.svoxDiskUsed
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Disk Used
        -
          uuid: 246b8560694349cb88c44c8da05ea871
          name:	'switchvoxHardwareStatus: svoxDiskTotal'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.3.2.2
          key:	switchvoxHardwareStatus.svoxDiskTotal
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Disk Total
        -
          uuid: 8253648fa56149b18212a351b9cc48bd
          name:	'switchvoxHardwareStatus: svoxDiskInfoLastUpdate'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.3.2.3
          key:	switchvoxHardwareStatus.svoxDiskInfoLastUpdate
          delay: 1h
          history: 90d
          trends: '0'
          value_type: TEXT
          description: |
                MIB: SWITCHVOX-MIB
                Disk Info Last Updated
        -
          uuid: f346b6849b9c417a94d0457f2ecb62f2
          name:	'switchvoxHardwareStatus: svoxLoad'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.3.3.1
          key:	switchvoxHardwareStatus.svoxLoad
          delay: 1h
          history: 90d
          trends: '0'
          value_type: TEXT
          description: |
                MIB: SWITCHVOX-MIB
                Details of the machines load
        -
          uuid: e18beac6ffcc403e8d751e187eb66f10
          name:	'switchvoxPhoneStatus: svoxPhoneStatus'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.4.1
          key:	switchvoxPhoneStatus.svoxPhoneStatus
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Current number of provisioned phones
                ::= { switchvoxPhoneStatus 1 }
        -
          uuid: 7642b231a48948b5a9b721f2fbc3bdb7
          name:	'switchvoxPhoneStatus: svoxAvailablePhoneStatus'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.22736.10.4.2
          key:	switchvoxPhoneStatus.svoxAvailablePhoneStatus
          delay: 1h
          history: 90d
          trends: '0'
          value_type: FLOAT
          description: |
                MIB: SWITCHVOX-MIB
                Current number of provisioned and available phones
                ::= { switchvoxPhoneStatus 2 }
      discovery_rules:
        -
          uuid: 060e2fa4b1fc47bf99f6dfdcfad15cc7
          name: 'switchvoxVoipProviders.discovery'
          type: SNMP_AGENT
          snmp_oid: 'walk[.1.3.6.1.4.1.22736.10.2.3]'
          key: switchvoxVoipProviders.discovery
          delay: 1h
          description: |
                MIB: SWITCHVOX-MIB
                Table with details of the currently active voip providers.
                ::= { switchvoxVoipProviders 3 }
                SvoxVoipProvEntry ::= SEQUENCE {
                    svoxVoipProvId	  Integer32,
                    svoxVoipProvName	  DisplayString,
                    svoxVoipProvHost	  DisplayString,
                    svoxVoipProvAcctId      Integer32,
                    svoxVoipProvCallBack    Integer32,
                    svoxVoipProvLatency     Integer32,
                    svoxVoipProvState	  DisplayString
                }
          preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      Array.prototype.contains = function(obj) {
                      var i = this.length;
                      while (i--) {
                          if (this[i] === obj) {
                              return true;
                          }
                      }
                      return false;
                      }
                      var arr = value.split("\n");
                      var snmp_id = [];
                      var data_id = {};
                      var data_name = {};
                      var result = "[\r\n";
                      for (var i = 0; i < arr.length; i++)
                      {
                          var test = arr[i].split(': ');
                          var value = test[1];
                          test = test[0].split(' = ');
                          var oid_data = test[0].split('.');
                          if (!snmp_id.contains(oid_data[oid_data.length - 2]))
                          {
                              snmp_id.push(oid_data[oid_data.length - 2])
                          }
                          if (oid_data[oid_data.length -1] == '1')
                          {
                              data_id[oid_data[oid_data.length - 2]] = value;
                          }
                          else if (oid_data[oid_data.length - 1] == '3')
                          {
                              data_name[oid_data[oid_data.length - 2]] = value;
                          }
                      }
                      for (var i = 0; i < snmp_id.length; i++)
                      {
                          result = result + '    {\r\n        "{#SNMPINDEX}": "' + snmp_id[i] + '",\r\n';
                          result = result + '        "{#DATAID}": "' + data_id[snmp_id[i]] + '",\r\n';
                          result = result + '        "{#DATANAME}": ' + data_name[snmp_id[i]] + '\r\n    }';
                          if (i == snmp_id.length - 1)
                          {
                              result = result + '\r\n';
                          }
                          else
                          {
                              result = result + ',\r\n';
                          }
                      }
                      result = result + ']';
                      return (result);
          item_prototypes:
            -
              uuid: 42bc67a9572c4ce892daf4cd6ec0a19e
              name: 'switchvoxVoipProviders {#DATAID}({#DATANAME}): svoxVoipProvType'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.22736.10.2.3.{#SNMPINDEX}.2'
              key: 'switchvoxVoipProviders[svoxVoipProvType.{#DATAID}]'
              delay: 1h
              value_type: TEXT
              description: |
                    MIB: SWITCHVOX-MIB
                    The VOIP Provider Type
            -
              uuid: d6c97d97332d417da104f24dcbc9f6dc
              name: 'switchvoxVoipProviders {#DATAID}({#DATANAME}): svoxVoipProvLatency'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.22736.10.2.3.{#SNMPINDEX}.7'
              key: 'switchvoxVoipProviders[svoxVoipProvLatency.{#DATAID}]'
              delay: 1h
              value_type: TEXT
              description: |
                    MIB: SWITCHVOX-MIB
                    The VOIP Provider Latency
            -
              uuid: 7335ce5b21144d4ebb2f4f1a8ca0d104
              name: 'switchvoxVoipProviders {#DATAID}({#DATANAME}): svoxVoipProvState'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.22736.10.2.3.{#SNMPINDEX}.8'
              key: 'switchvoxVoipProviders[svoxVoipProvState.{#DATAID}]'
              delay: 1h
              value_type: TEXT
              description: |
                    MIB: SWITCHVOX-MIB
                    The VOIP Provider State



        -
          uuid: 3e1d8907101246faa13cbed0e21c397d
          name: 'switchvoxPhoneStatus.discovery'
          type: SNMP_AGENT
          snmp_oid: 'walk[.1.3.6.1.4.1.22736.10.4.3]'
          key: switchvoxPhoneStatus.discovery
          delay: 1h
          description: |
                MIB: SWITCHVOX-MIB
                Table with details of the provisioned phones.
                ::= { switchvoxPhoneStatus 3 }
                SvoxPhoneStatusEntry ::= SEQUENCE {
                  svoxPhoneStatusId		Integer32,
                  svoxPhoneStatusExtension	Integer32,
                  svoxPhoneStatusCallerId	DisplayString,
                  svoxPhoneStatusUserAgent      DisplayString,
                  svoxPhoneStatusIpAddress    	DisplayString,
                  svoxPhoneStatusState	  	DisplayString
                }
          preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      Array.prototype.contains = function(obj) {
                      var i = this.length;
                      while (i--) {
                          if (this[i] === obj) {
                              return true;
                          }
                      }
                      return false;
                      }
                      var arr = value.split("\n");
                      var snmp_id = [];
                      var data_id = {};
                      var data_name = {};
                      var result = "[\r\n";
                      for (var i = 0; i < arr.length; i++)
                      {
                          var test = arr[i].split(': ');
                          var value = test[1];
                          test = test[0].split(' = ');
                          var oid_data = test[0].split('.');
                          if (!snmp_id.contains(oid_data[oid_data.length - 2]))
                          {
                              snmp_id.push(oid_data[oid_data.length - 2])
                          }
                          if (oid_data[oid_data.length -1] == '1')
                          {
                              data_id[oid_data[oid_data.length - 2]] = value;
                          }
                          else if (oid_data[oid_data.length - 1] == '2')
                          {
                              data_name[oid_data[oid_data.length - 2]] = value;
                          }
                      }
                      for (var i = 0; i < snmp_id.length; i++)
                      {
                          result = result + '    {\r\n        "{#SNMPINDEX}": "' + snmp_id[i] + '",\r\n';
                          result = result + '        "{#DATAID}": "' + data_id[snmp_id[i]] + '",\r\n';
                          result = result + '        "{#DATANAME}": ' + data_name[snmp_id[i]] + '\r\n    }';
                          if (i == snmp_id.length - 1)
                          {
                              result = result + '\r\n';
                          }
                          else
                          {
                              result = result + ',\r\n';
                          }
                      }
                      result = result + ']';
                      return (result);
          item_prototypes:
            -
              uuid: 6ebbd14434094646a59c89414b0d8e6c
              name: 'switchvoxPhoneStatus {#DATAID}({#DATANAME}): svoxPhoneStatusState'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.22736.10.4.3.{#SNMPINDEX}.6'
              key: 'switchvoxPhoneStatus[svoxPhoneStatusState.{#SNMPINDEX}.{#DATAID}]'
              delay: 1h
              value_type: TEXT
              description: |
                    MIB: SWITCHVOX-MIB
                    The SIP Phone Status